{"version":3,"file":"logger-decorator.umd.js","sources":["../src/lib/utils.ts","../src/lib/opt/default-base-option.ts","../src/lib/opt/default-function-option.ts","../src/lib/message.ts","../src/lib/performance-now-polyfill.ts","../src/lib/function-wrapper.ts","../src/function-decorator.ts","../src/lib/opt/default-class-option.ts","../src/class-decorator.ts","../src/normal-decorator.ts"],"sourcesContent":["const STRIP_COMMENTS = /((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg\nconst ARGUMENT_NAMES = /([^\\s,]+)/g\n\n/**\n * Return the keys of the target object\n * @param data target object\n * @return the keys of the input object\n */\nexport const keys = (data: Object) => {\n  return Object.keys(data)\n}\n\n/**\n * Get the parameters of one function\n * @param func target function\n * @return the parameters of function\n */\nexport const getArsName = (func: Function) => {\n  const fnStr = func.toString().replace(STRIP_COMMENTS, '')\n  const result = fnStr.slice(fnStr.indexOf('(') + 1, fnStr.indexOf(')')).match(ARGUMENT_NAMES) || []\n  return result\n}\n\n/**\n * Check if the target object is empty of not\n * @param obj target object\n * @return whether the object is empty or not\n */\nexport const isObjEmpty = (obj: any) => {\n  return obj && Object.keys(obj).length === 0 && obj.constructor === Object\n}\n\n/**\n * A function that check if the script is running on node or not.\n * @return whether running on nodejs environment\n */\nexport const runningOnNode = () => {\n  return typeof window === 'undefined'\n}","import { IBaseOption } from './../interface/IBaseOption';\n\nexport const defaultOpt: IBaseOption = {\n  classProperties: false,\n  log: console.log,\n  withTime: true,\n  disable: false,\n  duration: false,\n}\n","import { IFunctionOption } from './../interface/IFunctionOption';\nimport { defaultOpt } from './default-base-option'\n\nexport const defaultFuncOpt: IFunctionOption = Object.assign(defaultOpt, {\n  withParams: false,\n  logReturn: false,\n  beginMessage: ''\n})\n","import { getArsName } from './utils';\nimport { IFunctionOption } from './interface/IFunctionOption';\n\nconst TAB = '    '\n\nconst getArgsList = (func: Function, values: any[]) => {\n  return getArsName(func).map((param, index) => {\n    return `${param}: ${values[index]}`\n  }).join(',')\n}\n\nconst concatMsg = (...args: string[]): string => {\n  return args.filter(el => el && el !== '').join(' ')\n}\n\nconst getProperties = (classObj: any): string => {\n  return Object.keys(classObj).reduce((msg: string[], el) => {\n    msg.push(`${el}: ${classObj[el]}`)\n    return msg\n  }, []).join(' ')\n}\n\nexport const message = (\n  options: IFunctionOption,\n  that: any,\n  arg: any[],\n  name: string,\n  func: Function,\n) => {\n  const logger = options.log || console.log\n\n\n  // print basic info of function\n  const className = (that && that.constructor && that.constructor.name) || ''\n  const time = options.withTime ? (new Date()).toISOString() : ''\n  logger(concatMsg(time, `[${className}#${name}] START`))\n\n  // print begin message if there are any\n  options.beginMessage && logger(`${TAB}${options.beginMessage}`)\n\n  options.classProperties && logger(`${TAB}Class Properties: [${getProperties(that)}]`)\n\n  // print parameters of function\n  options.withParams && logger(`${TAB}Parameters: [${getArgsList(func, arg)}]`)\n}\n\nexport const messageEnd = (\n  options: IFunctionOption,\n  duration: number,\n  that: any,\n  name: string,\n  returnValue?: any\n) => {\n  const logger = options.log || console.log\n\n  options.duration && logger(`${TAB}Function spent: ${duration.toFixed(3)}ms`)\n\n  options.logReturn && returnValue && logger(`${TAB}Return Value: ${returnValue}`)\n\n  const className = (that && that.constructor && that.constructor.name) || ''\n  logger(`[${className}#${name}] END`)\n}\n","/**\n * @return return the current time info when on node environment\n */\nconst getTimeOnNode = () => {\n  const hrTime = process.hrtime()\n  return hrTime[0] * 1e9 + hrTime[1]\n}\n\n/**\n * Polyfill of performance.now function\n * Get the value of performance.now() on both node or web browser.\n * @return the performance.now()\n */\nexport const now = () => {\n  if (typeof performance !== 'undefined' && typeof performance.now === 'function') {\n    return performance.now()\n  } else if (typeof process !== undefined && typeof process.hrtime === 'function') {\n    return (function(loadTime) {\n      return (getTimeOnNode() - loadTime) / 1e9\n    })(getTimeOnNode() - (process.uptime() * 1e9))\n  } else {\n    return (function(loadTime) {\n      return (new Date()).getTime() - loadTime\n    })((new Date).getTime())\n  }\n}","import { IFunctionOption } from './interface/IFunctionOption';\nimport { message, messageEnd } from './message'\nimport { now } from './performance-now-polyfill'\n\nexport const FunctionWrapper = (\n  func: Function,\n  funcName: string,\n  options: IFunctionOption\n) => {\n  return function(...args: any[]) {\n    message(options, this, args, funcName, func)\n    const startTime = now()\n    const result = func.apply(this, args)\n    messageEnd(options, (now() - startTime), this, funcName, result)\n    return result\n  }\n}","import { isObjEmpty } from './lib/utils';\nimport { defaultFuncOpt } from './lib/opt/default-function-option';\nimport { IFunctionOption } from './lib/interface/IFunctionOption';\nimport { FunctionWrapper } from './lib/function-wrapper';\n\nconst decorateFunc = (descriptor: any, field: string, value: any) => {\n  const oldFunc = descriptor.value\n  oldFunc[field] = value\n  descriptor.value = oldFunc\n  return descriptor\n}\n\nexport const FuncLogger = (opt?: Partial<IFunctionOption>) => {\n  return function(target: any, name: string, descriptor: any) {\n    return isObjEmpty(opt) ? descriptor : decorateFunc(descriptor, '__opt', opt)\n  }\n}\n\nexport const DisableLogger = () => {\n  return function(target: any, name: String, descriptor: any) {\n    return decorateFunc(descriptor, '__disable_logger', true)\n  }\n}\n\nexport const Logger = (opt?: Partial<IFunctionOption>) => {\n  const options = {...defaultFuncOpt, ...opt}\n  return function(target: any, name: string, descriptor: any) {\n    if (options.disable) return descriptor\n    const oldFunc = descriptor.value\n    descriptor.value = FunctionWrapper(oldFunc, name, options)\n    return descriptor\n  }\n}","import { defaultFuncOpt } from './default-function-option';\nimport { IClassOption } from './../interface/IClassOption';\n\nexport const defaultClassOpt: IClassOption = Object.assign(defaultFuncOpt, {})","import { defaultClassOpt } from './lib/opt/default-class-option';\nimport { IClassOption } from './lib/interface/IClassOption';\nimport { keys } from './lib/utils'\nimport { FunctionWrapper } from './lib/function-wrapper'\n\nexport const ClassLogger = (opt?: Partial<IClassOption>) => {\n  let options = {...defaultClassOpt, ...opt}\n  return (target: any) => {\n    if (options.disable) return\n    keys(target.prototype).map(funcName => {\n      const oldFunc = target.prototype[funcName]\n\n      if (oldFunc.__disable_logger) return\n\n      const individualOpt = oldFunc.__opt ? {...options, ...oldFunc.__opt } : options\n      if (individualOpt.disable) return\n      target.prototype[funcName] = FunctionWrapper(oldFunc, funcName, individualOpt)\n    })\n  }\n}\n","import { IFunctionOption } from './lib/interface/IFunctionOption'\nimport { defaultFuncOpt } from './lib/opt/default-function-option';\nimport { FunctionWrapper } from './lib/function-wrapper';\n\nexport const logDecorate = (opt?: Partial<IFunctionOption>) => {\n  const options = {...defaultFuncOpt, ...opt}\n  return (...args: Function[]): any => {\n    return args.reduce(function(result: any, el: Function) {\n      const funcName = el.name\n      el = FunctionWrapper(el, funcName, options)\n      result[funcName] = el\n      return result\n    }, {})\n  }\n}"],"names":[],"mappings":"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"}